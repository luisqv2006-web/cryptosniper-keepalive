def analizar():
    send("ğŸš€ CryptoSniper FX â€” Modo Profesional Activado")
    actualizar_estado("Bot activo âœ…")

    ultima_senal = datetime.now(mx)

    while True:
        ahora = datetime.now(mx)
        fecha = ahora.strftime("%Y-%m-%d")

        for asset in SYMBOLS.keys():

            velas5m = obtener_velas(asset, "5m")
            if not velas5m:
                continue

            cons = detectar_confluencias(velas5m)
            total = sum(cons.values())
            price = velas5m[-1][4]

            # ğŸŸ¡ PRE-ALERTA â€” 3 CONFLUENCIAS
            if total == 3:
                send(
                    f"ğŸŸ¡ <b>PRE-ALERTA</b>\n"
                    f"ğŸ“Œ {asset}\n"
                    f"ğŸ§© 3 confluencias detectadas\n"
                    f"â³ Posible entrada prÃ³xima"
                )

            # ğŸ”´ EJECUCIÃ“N â€” 4 CONFLUENCIAS
            if total >= 4:
                msg = procesar_senal(asset, cons, price)
                if msg:
                    send(msg)
                    ultima_senal = datetime.now(mx)

        # ğŸ§  MENSAJE DE VIDA CADA 55 MIN
        if datetime.now(mx) - ultima_senal >= timedelta(minutes=55):
            send("ğŸ§  El bot sigue analizando el mercado en tiempo realâ€¦")
            actualizar_estado("Activo y analizando âœ…")
            ultima_senal = datetime.now(mx)

        # â³ ANÃLISIS CADA 1 MINUTO (CLAVE DEL Ã‰XITO)
        time.sleep(60)
