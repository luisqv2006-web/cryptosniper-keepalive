# ================================
# ğŸ” CONTEXTO 5M + GATILLO 1M (BINARIAS)
# ================================
def detectar_confluencias(velas_5m, velas_1m):
    ohlc_5m = [(x[1], x[2], x[3], x[4]) for x in velas_5m[-10:]]
    ohlc_1m = [(x[1], x[2], x[3], x[4]) for x in velas_1m[-6:]]

    o5, h5, l5, c5 = zip(*ohlc_5m)
    o1, h1, l1, c1 = zip(*ohlc_1m)

    # ğŸ“Œ CONTEXTO (5M)
    estructura_alcista = c5[-1] > h5[-2]
    estructura_bajista = c5[-1] < l5[-2]

    # âš¡ GATILLO (1M)
    vela_fuerte = abs(c1[-1] - o1[-1]) > (h1[-1] - l1[-1]) * 0.6
    ruptura_micro = c1[-1] > h1[-2] or c1[-1] < l1[-2]

    return {
        "CONTEXTO": estructura_alcista or estructura_bajista,
        "GATILLO": vela_fuerte and ruptura_micro
    }
